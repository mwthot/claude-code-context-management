{
  "permissions": {
    "allow": [
      "Read(*.{java,yaml,json,md,sql})",
      "Bash(docker-compose:*)",
      "Bash(kubectl:*)",
      "Bash(mvn:*)",
      "Bash(git status:*)",
      "Bash(git diff:*)",
      "Bash(git log:*)"
    ],
    "deny": [
      "Bash(rm -rf:*)",
      "Bash(sudo:*)",
      "Bash(kubectl delete:*)",
      "Write(*.{jar,class})",
      "Edit(**/pom.xml)",
      "Edit(**/*-prod.yml)",
      "Edit(**/*-production.yml)"
    ],
    "additionalDirectories": [
      "docs/",
      "infrastructure/"
    ]
  },
  "env": {
    "JAVA_HOME": "/usr/lib/jvm/java-21",
    "SPRING_PROFILES_ACTIVE": "local",
    "DATABASE_URL": "postgresql://localhost:5432/ecommerce_dev"
  },
  "hooks": {
    "PreCompact": [
      {
        "matcher": "auto", 
        "hooks": [
          {
            "type": "command", 
            "command": "echo 'Preserve: service architecture, current feature context, debugging state, established patterns' > /tmp/compact-instructions"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"Executing: $(echo '$HOOK_INPUT' | jq -r '.tool_input.command')\" >> ~/.claude/command-audit.log"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit|Write|Bash",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"$(date +%H:%M:%S),$TOOL_NAME,$(echo '$HOOK_INPUT' | jq -r '.tool_input.file_path // .tool_input.command // \"unknown\"' 2>/dev/null || echo 'unknown')\" >> .claude/metrics/activity.log"
          }
        ]
      }
    ]
  }
}